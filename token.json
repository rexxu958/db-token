{
  "_meta": {
    "registry_name": "token-fabric-enterprise",
    "schema_version": "v5.9.4",
    "description": "High-fidelity dual-token configuration for distributed Telegram bot orchestration with multi-policy, crypto-fingerprint validation, and automated health-sync pipelines.",
    "generated_at": "2025-10-04T00:00:00Z",
    "checksum": "sha512:4e82f9c8f2b6b0f8b47db09efac772cbe5f9caa1a7df5a1f492fb2eab5e3a1a90f7cd9bb8da2a6327f39d27aa7f42f5a4a88ad9031e5a0113e5f497a34b7d55a"
  },

  "environment": {
    "active_cluster": "production",
    "fallback_cluster": "mirror-backup",
    "sync_policy": {
      "interval_minutes": 15,
      "parallel_validation": true,
      "integrity_mode": "strong-consistency",
      "audit_signature_required": true
    },
    "encryption": {
      "algorithm": "aes-256-gcm",
      "key_rotation_days": 14,
      "salt_source": "systemd-entropy",
      "public_fingerprint": "sha256:9f2a...b8cd"
    }
  },

  "clusters": {
    "production": {
      "region": "asia-southeast-1",
      "policy": {
        "rotation_strategy": "adaptive-weighted",
        "heartbeat_interval_seconds": 20,
        "error_threshold_percent": 2.5,
        "telemetry_stream": "wss://telemetry.api.prod/v2",
        "auto_recover_on_fault": true
      },
      "token_nodes": [
        {
          "token": "8406299333:AAG7MwwkpOgfnDTHXqh1Mz61vLB8T7fT5t0",
          "fingerprint": "sha256:7b8e...e29d",
          "weight": 70,
          "policies": {
            "max_rps": 5000,
            "priority": "critical",
            "timeout_ms": 2000,
            "retry_backoff_ms": 150,
            "allow_parallel_dispatch": true
          },
          "monitoring": {
            "health_endpoint": "https://status.prod.cluster/api/ping",
            "last_latency_ms": 86,
            "uptime_percent": 99.992,
            "fail_count_24h": 1,
            "last_fail_reason": null
          },
          "crypto": {
            "signature": "ed25519:0aa1e7b1c9f84d91a9a...",
            "key_ref": "vault:prod/botkey_primary"
          },
          "hooks": {
            "onRotate": "scripts/hooks/notify_rotation.sh",
            "onFailure": "scripts/hooks/auto_recover.js"
          }
        }
      ]
    },

    "mirror-backup": {
      "region": "eu-west-2",
      "policy": {
        "rotation_strategy": "sequential-fallback",
        "heartbeat_interval_seconds": 45,
        "error_threshold_percent": 5,
        "telemetry_stream": "wss://telemetry.api.backup/v2",
        "auto_recover_on_fault": false
      },
      "token_nodes": [
        {
          "token": "8435506507:AAHZD5KK17wiJx83arUKlCdLpat_TbhwSYs",
          "fingerprint": "sha256:1e2c...9b77",
          "weight": 30,
          "policies": {
            "max_rps": 2500,
            "priority": "standard",
            "timeout_ms": 3000,
            "retry_backoff_ms": 300,
            "allow_parallel_dispatch": false
          },
          "monitoring": {
            "health_endpoint": "https://status.backup.cluster/api/ping",
            "last_latency_ms": 124,
            "uptime_percent": 99.971,
            "fail_count_24h": 3,
            "last_fail_reason": "network_timeout"
          },
          "crypto": {
            "signature": "ed25519:db58bfa6a21fce90dd7...",
            "key_ref": "vault:backup/botkey_reserve"
          },
          "hooks": {
            "onRotate": "scripts/hooks/notify_backup_rotation.sh",
            "onFailure": "scripts/hooks/escalate_alert.js"
          }
        }
      ]
    }
  },

  "observability": {
    "logging": {
      "level": "verbose",
      "rotation_days": 7,
      "compress_archives": true,
      "path": "./logs/token_fabric/",
      "max_file_size_mb": 50
    },
    "metrics": {
      "collector": "https://metrics.fabric.dev/v1/collect",
      "interval_seconds": 30,
      "fields": [
        "latency_ms",
        "rps",
        "uptime_percent",
        "error_rate",
        "rotation_event"
      ]
    },
    "alerting": {
      "enabled": true,
      "thresholds": {
        "latency_warning_ms": 250,
        "error_rate_percent": 5
      },
      "channels": [
        "slack:#ops-alerts",
        "email:infra-team@example.com"
      ]
    }
  },

  "automation": {
    "tasks": [
      {
        "name": "auto-rotate-main",
        "trigger": "time-based",
        "interval_minutes": 60,
        "action": "node scripts/rotate_main.js"
      },
      {
        "name": "integrity-check",
        "trigger": "on-deploy",
        "action": "bash scripts/verify_fingerprints.sh"
      }
    ],
    "recovery": {
      "mode": "graceful",
      "max_attempts": 3,
      "cooldown_seconds": 180,
      "notify_team": true
    }
  },

  "devtools": {
    "cli": {
      "commands": {
        "rotate": "node cli/rotate --cluster production",
        "sync": "node cli/sync --all",
        "stats": "node cli/stats --json"
      },
      "default_timeout_s": 25
    },
    "linting": {
      "enabled": true,
      "ruleset": "strict-secure-v2",
      "ignore": ["_meta.checksum"]
    }
  }
}
